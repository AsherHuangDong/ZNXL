webpackJsonp([10],{P3Yo:function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var n={name:"questionnaireAdd",data:function(){return{momentName:"",modal2:!1,count:[],imgSrc:"",isshow:!0,title:"",description:"",index:"",scorce:{beginScore:"",endScore:""},questionlist:{evaluationId:"",dimensionList:[{dimensionId:"",scoreExplanList:[{beginScore:"",endScore:"",explan:""}]}]},weidulist:[],evaluationId:"",weiduAdd:{evaluationId:"",dimensionNameList:[]},Question:{evaluationId:"",questionList:[{questionName:"",dimensionList:[],optionList:[{optionName:"",optionScore:""}]}]},explain:{evaluationId:"",dimensionList:[]},addQuestion:{title:"",cover:"",introduct:""}}},methods:{handleAdd:function(){this.modal2=!0},ok:function(){var t=this;this.momentName?(this.weiduAdd.dimensionName=this.momentName,this.$axios.post("api/evaluationDimension/addEvaluationDimension",this.weiduAdd).then(function(i){console.log(i),t.modal2=!1,t.weidulist.push({dimensionId:i.data.data.dimensionId,dimensionName:i.data.data.dimensionName,scoreExplanList:[{beginScore:"",endScore:"",explan:""}]}),console.log(t.weidulist),t.momentName=""})):this.$Message.error("请输入维度名!!")},cancel:function(){this.modal2=!1},handleClose2:function(t,i){this.weidulist.splice(t,1),console.log("questionList",this.Question.questionList),this.Question.questionList&&this.Question.questionList.forEach(function(t){for(var e=-1,n=0;n<t.dimensionList.length;n++)t.dimensionList[n].dimensionId==i&&(e=n);console.log("m",e),e>=0&&t.dimensionList.splice(e,1)}),this.$axios.post("api/evaluationDimension/deleteEvaluationDimension",{id:i}).then(function(t){console.log(t)})},handleClose:function(t,i){this.Question.questionList[t].dimensionList.splice(i,1)},Maddimg:function(){var t=this,i=document.getElementById("addMainImg");i.click(),i.onchange=function(i){var e=new FormData;e.append("img",this.files[0]),t.$axios.post("api/file/upload",e).then(function(i){console.log(i.data),t.addQuestion.cover=i.data.data.filePath});var n=new FileReader;n.readAsDataURL(this.files[0]),n.onload=function(i){t.imgSrc=i.target.result}}},gotoNext:function(){var t=this;console.log(this.addQuestion),this.evaluationId?this.isshow=!1:this.addQuestion.title&&this.addQuestion.cover&&this.addQuestion.introduct?this.$axios.post("api/evaluation/addEvaluation",this.addQuestion).then(function(i){console.log(i),t.evaluationId=i.data.data.evaluationId,t.weiduAdd.evaluationId=i.data.data.evaluationId,t.questionlist.evaluationId=i.data.data.evaluationId,t.explain.evaluationId=i.data.data.evaluationId,t.Question.evaluationId=i.data.data.evaluationId,t.isshow=!1}):this.$Message.error("存在未填写选项，请填写完成后重试！")},gotoLast:function(){this.isshow=!0},save:function(){var t=this;if(console.log("weidulist",this.weidulist),console.log("questionList",this.Question.questionList),0!=this.weidulist.length){var i=1,e=1;if(this.explain.dimensionList=window.JSON.parse(window.JSON.stringify(this.weidulist)),this.explain.dimensionList.forEach(function(t){delete t.dimensionName;for(var e=0;e<t.scoreExplanList.length;e++)t.scoreExplanList[e].explan&&t.scoreExplanList[e].beginScore&&t.scoreExplanList[e].endScore||(i=2)}),this.Question.questionList.forEach(function(t,n){t.questionName||(i=2);for(var o=0;o<t.optionList.length;o++)t.optionList[o].optionName&&t.optionList[o].optionScore||(i=2);0==t.dimensionList.length&&(e=2)}),1==i&&1==e){console.log("Question",this.Question),this.Question.questionList.forEach(function(t){t.optionList.forEach(function(t){t.optionScore=parseInt(t.optionScore)});for(var i=0;i<t.dimensionList.length;i++)t.dimensionList[i]=t.dimensionList[i].dimensionId}),console.log("explain",this.explain),console.log("Question",this.Question),this.$axios.post("api/evaluationQuestion/addEvaluationQuestion",this.Question).then(function(i){console.log(i),0!=i.data.code&&t.$Message.error(i.data.msg)}),this.$axios.post("api/evaluationDimensionExplan/addEvaluationDimensionExplan",this.explain).then(function(i){console.log(i),0!=i.data.code?t.$Message.error(i.data.msg):(t.$Message.success("添加成功！"),t.$router.go(-1))})}else 1==i&&2==e?this.$Message.error("请添加维度!"):this.$Message.error("请将信息填写完后重试!")}else this.$router.go(-1)},addTitle:function(t){this.Question.questionList.splice(t+1,0,{questionName:"",dimensionList:[],optionList:[{optionName:"",optionScore:""}]})},addPrint:function(t){this.Question.questionList[t].optionList.push({optionName:"",optionScore:""})},deleteQ:function(t){this.Question.questionList.splice(t,1)},deleteC:function(t,i){this.Question.questionList[t].optionList.splice(i,1)},gotoAdd:function(t){console.log(t);var i=t.split("+"),e=parseInt(i[0]),n=i[1];console.log(i);var o=1;this.Question.questionList[this.index].dimensionList.forEach(function(t){t.dimensionId==e&&(o=2)}),2==o&&this.$Message.error("已存在维度!!!"),1==o&&this.Question.questionList[this.index].dimensionList.push({dimensionId:e,dimensionName:n}),console.log("Question",this.Question.questionList)},getIndex:function(t){console.log(t),this.index=t},addExplain:function(t,i){this.weidulist[t].scoreExplanList.splice(i+1,0,{beginScore:"",endScore:"",explan:""}),this.$forceUpdate(),console.log(this.weidulist)},deleteE:function(t,i){this.weidulist[t].scoreExplanList.splice(i,1),this.$forceUpdate(),console.log(this.weidulist)},goback:function(){this.$router.go(-1)},change:function(){console.log("fjdkjfd",new data),this.reload=new data}}},o={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",[e("Modal",{attrs:{closable:!1},model:{value:t.modal2,callback:function(i){t.modal2=i},expression:"modal2"}},[e("Input",{attrs:{placeholder:"请输入维度名"},model:{value:t.momentName,callback:function(i){t.momentName=i},expression:"momentName"}}),t._v(" "),e("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[e("Button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:t.ok}},[t._v("确认")]),t._v(" "),e("Button",{staticStyle:{width:"100px"},on:{click:t.cancel}},[t._v("取消")])],1)],1),t._v(" "),e("Row",[e("Col",[e("Button",{attrs:{type:"info"},on:{click:t.goback}},[t._v("返回")])],1)],1),t._v(" "),t.isshow?e("div",{staticClass:"question"},[t._m(0),t._v(" "),t._m(1),t._v(" "),e("div",{staticStyle:{"margin-top":"20px"}},[e("span",{staticStyle:{color:"#07175D","margin-right":"20px"}},[t._v("问卷标题")]),t._v(" "),e("Input",{staticStyle:{width:"400px"},attrs:{placeholder:"预设提示文字"},model:{value:t.addQuestion.title,callback:function(i){t.$set(t.addQuestion,"title",i)},expression:"addQuestion.title"}})],1),t._v(" "),e("div",{staticClass:"cover",staticStyle:{"margin-top":"10px"}},[e("span",{staticStyle:{color:"#07175D","margin-right":"25px"}},[t._v("问卷封面")]),t._v(" "),e("Button",{staticStyle:{width:"100px",height:"100px",background:"#eee","margin-right":"10px"},attrs:{icon:"md-add",type:"dashed"},on:{click:t.Maddimg}},[e("br"),t._v(" "),e("span",{staticStyle:{"margin-top":"10px"}},[t._v("上传")])]),t._v(" "),e("input",{staticStyle:{opacity:"0",height:"0",width:"0"},attrs:{id:"addMainImg",type:"file",accept:".png, .jpg, .jpeg"}}),t._v(" "),t.imgSrc?e("div",{staticStyle:{width:"100px",height:"100px",border:"1px solid black","border-style":"dotted"}},[e("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:t.imgSrc}})]):t._e()],1),t._v(" "),e("span",{staticStyle:{color:"#ccc","margin-left":"80px"}},[t._v("支持扩展名：.jpg .jpeg .png ...，建议图片尺寸")]),t._v(" "),e("div",{staticStyle:{"margin-top":"10px"}},[e("span",{staticStyle:{color:"#07175D","margin-right":"35px"}},[t._v("指导语")]),t._v(" "),e("Input",{staticStyle:{width:"400px"},attrs:{type:"textarea",rows:4},model:{value:t.addQuestion.introduct,callback:function(i){t.$set(t.addQuestion,"introduct",i)},expression:"addQuestion.introduct"}})],1),t._v(" "),e("div",{staticStyle:{"margin-top":"40px","margin-left":"200px"}},[e("Button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:t.gotoNext}},[t._v("下一步")])],1)]):t._e(),t._v(" "),t.isshow?t._e():e("div",[e("Row",[e("div",{staticStyle:{"text-align":"center"}},[e("img",{staticStyle:{width:"30px",height:"30px"},attrs:{src:"/static/img/stop.png"}}),t._v(" "),e("img",{staticStyle:{width:"400px",height:"30px",overflow:"hidden"},attrs:{src:"/static/img/line1.png"}}),t._v(" "),e("img",{staticStyle:{width:"30px",height:"30px"},attrs:{src:"/static/img/tow.png"}})])]),t._v(" "),e("Row",[e("Col",{attrs:{span:"24"}},[e("div",{staticStyle:{"text-align":"center"}},[e("span",{staticStyle:{color:"black","margin-right":"320px"}},[t._v("填写问卷基本信息")]),t._v(" "),e("span",{staticStyle:{color:"black"}},[t._v("设置问卷题目与解释")])])])],1),t._v(" "),e("br"),t._v(" "),e("Row",[e("Col",{attrs:{span:"24",offset:"5"}},[e("div",{staticStyle:{display:"flex","justify-content":"flex-start","align-item":"flex-start"}},[e("div",{staticStyle:{width:"4px",height:"20px",background:"#07175D",display:"inline-block","margin-right":"5px"}}),t._v(" "),e("div",{staticStyle:{display:"inline-block",color:"#07175D"}},[e("h1",{staticStyle:{"font-size":"15px"}},[t._v("问卷维度")])])])])],1),t._v(" "),e("br"),t._v(" "),e("Row",[e("Col",{attrs:{span:"24",offset:"5"}},[e("div",{staticStyle:{float:"left",width:"500px"}},[t._l(t.weidulist,function(i,n){return e("Tag",{key:i.dimensionId,attrs:{name:n,closable:""},on:{"on-close":function(e){return t.handleClose2(n,i.dimensionId)}}},[t._v(t._s(i.dimensionName))])}),t._v(" "),e("Button",{attrs:{icon:"ios-add",type:"dashed",size:"small"},on:{click:t.handleAdd}},[t._v("添加标签")])],2)])],1),t._v(" "),e("br"),t._v(" "),e("Row",[e("Col",{attrs:{span:"24",offset:"5"}},[e("div",{staticStyle:{display:"flex","justify-content":"flex-start","align-item":"flex-start"}},[e("div",{staticStyle:{width:"4px",height:"20px",background:"#07175D",display:"inline-block","margin-right":"5px"}}),t._v(" "),e("div",{staticStyle:{display:"inline-block",color:"#07175D"}},[e("h1",{staticStyle:{"font-size":"15px"}},[t._v("问卷题目")])])])])],1),t._v(" "),e("br"),t._v(" "),e("Row",[e("Col",{attrs:{span:"24"}},[e("div",{staticStyle:{float:"left","margin-left":"240px"}},t._l(t.Question.questionList,function(i,n){return e("div",{key:n,staticStyle:{"margin-bottom":"10px"}},[e("div",{staticStyle:{display:"flex","justify-content":"flex-start","align-items":"center"}},[0!==n?e("img",{staticStyle:{width:"15px",height:"15px",cursor:"pointer","margin-right":"5px"},attrs:{src:"static/img/remove.png"},on:{click:function(i){return t.deleteQ(n)}}}):t._e(),t._v(" "),e("div",{staticStyle:{width:"20px",color:"#07175D",display:"inline-block"}},[t._v(t._s(n+1)+".")]),t._v(" "),e("Input",{staticStyle:{display:"inline-block",width:"385px"},model:{value:i.questionName,callback:function(e){t.$set(i,"questionName",e)},expression:"item.questionName"}}),t._v(" "),e("Button",{staticStyle:{display:"inline-block",height:"34px","margin-left":"5px"},attrs:{type:"info"},on:{click:function(i){return t.addTitle(n)}}},[t._v("+添加")])],1),t._v(" "),t._l(i.optionList,function(i,o){return e("div",{key:o,staticStyle:{"margin-top":"10px","margin-left":"40px"}},[0!=o?e("img",{staticStyle:{width:"12px",height:"12px",display:"inline-block",cursor:"pointer"},attrs:{src:"static/img/remove.png"},on:{click:function(i){return t.deleteC(n,o)}}}):t._e(),t._v(" "),e("div",{staticStyle:{width:"40px","text-align":"right",color:"#07175D",display:"inline-block"}},[t._v("选项"+t._s(o+1)+":")]),t._v(" "),e("Input",{staticStyle:{width:"194px",display:"inline-block"},attrs:{placeholder:"选项描述"},model:{value:i.optionName,callback:function(e){t.$set(i,"optionName",e)},expression:"item1.optionName"}}),t._v(" "),e("div",{staticStyle:{width:"80px","text-align":"right",color:"#07175D",display:"inline-block"}},[t._v("得分:")]),t._v(" "),e("Input",{staticStyle:{width:"76px",display:"inline-block"},attrs:{type:"number"},model:{value:i.optionScore,callback:function(e){t.$set(i,"optionScore",e)},expression:"item1.optionScore"}})],1)}),t._v(" "),e("div",{staticStyle:{width:"80px","text-align":"left","margin-left":"40px","margin-top":"10px"},on:{click:function(i){return t.addPrint(n)}}},[e("a",{staticStyle:{color:"blue"}},[t._v("新增选项")])]),t._v(" "),e("div",{staticStyle:{"text-align":"left","margin-top":"10px"}},[e("div",{staticStyle:{width:"70px","text-align":"right",color:"#07175D",display:"inline-block"}},[t._v("维度:")]),t._v(" "),e("div",{staticStyle:{"text-align":"left",display:"inline-block"}},t._l(i.dimensionList,function(i,o){return e("Tag",{key:o,attrs:{name:o,closable:""},on:{"on-close":function(i){return t.handleClose(n,o)}}},[t._v(t._s(i.dimensionName))])}),1),t._v(" "),e("Dropdown",{on:{"on-click":t.gotoAdd}},[e("Button",{attrs:{icon:"ios-add",type:"dashed",size:"small"},on:{click:function(i){return t.getIndex(n)}}},[t._v("新增")]),t._v(" "),e("DropdownMenu",{attrs:{slot:"list"},slot:"list"},t._l(t.weidulist,function(i){return e("DropdownItem",{key:i.dimensionId,attrs:{name:i.dimensionId+"+"+i.dimensionName}},[t._v(t._s(i.dimensionName))])}),1)],1)],1)],2)}),0)])],1),t._v(" "),e("br"),t._v(" "),e("Row",[e("Col",{attrs:{span:"24",offset:"5"}},[e("div",{staticStyle:{display:"flex","justify-content":"flex-start","align-items":"flex-start"}},[e("div",{staticStyle:{width:"4px",height:"20px",background:"#07175D",display:"inline-block","margin-right":"5px"}}),t._v(" "),e("div",{staticStyle:{display:"inline-block",color:"#07175D"}},[e("h1",{staticStyle:{"font-size":"15px"}},[t._v("问卷解释")])])])])],1),t._v(" "),e("br"),t._v(" "),e("Row",[e("Col",{attrs:{span:"24"}},[e("Tabs",{staticStyle:{"margin-bottom":"10px",float:"left","margin-left":"240px"},on:{"on-change":t.change}},t._l(t.weidulist,function(i,n){return e("TabPane",{key:n,attrs:{label:i.dimensionName}},[e("div",[e("span",{staticStyle:{color:"#07175D"}},[t._v("得分范围:")])]),t._v(" "),e("br"),t._v(" "),e("div",{staticStyle:{float:"left"}},t._l(i.scoreExplanList,function(i,o){return e("div",{key:o,staticStyle:{"margin-bottom":"10px"}},[e("div",{staticStyle:{display:"flex","justify-content":"flex-start","align-items":"center"}},[0!==o?e("img",{staticStyle:{width:"15px",height:"15px",cursor:"pointer","margin-right":"5px"},attrs:{src:"static/img/remove.png"},on:{click:function(i){return t.deleteE(n,o)}}}):t._e(),t._v(" "),e("div",{staticStyle:{width:"20px",color:"#07175D",display:"inline-block"}},[t._v(t._s(o+1)+".")]),t._v(" "),e("Input",{staticStyle:{display:"inline-block",width:"81px"},attrs:{type:"number"},model:{value:i.beginScore,callback:function(e){t.$set(i,"beginScore",e)},expression:"item5.beginScore"}}),t._v(" "),e("img",{staticStyle:{width:"50px",height:"10px",overflow:"hidden",display:"inline-block"},attrs:{src:"/static/img/line.png"}}),t._v(" "),e("Input",{staticStyle:{display:"inline-block",width:"81px"},attrs:{type:"number"},model:{value:i.endScore,callback:function(e){t.$set(i,"endScore",e)},expression:"item5.endScore"}}),t._v(" "),e("Button",{staticStyle:{display:"inline-block",height:"34px","margin-left":"5px"},attrs:{type:"info"},on:{click:function(i){return t.addExplain(n,o)}}},[t._v("+添加")])],1),t._v(" "),e("Input",{staticStyle:{width:"399px",height:"118px","margin-top":"10px","margin-left":"25px"},attrs:{type:"textarea",rows:4,placeholder:"解释和干预"},model:{value:i.explan,callback:function(e){t.$set(i,"explan",e)},expression:"item5.explan"}})],1)}),0)])}),1)],1)],1),t._v(" "),e("Row",[e("Col",{attrs:{span:"24"}},[e("div",{staticStyle:{"margin-bottom":"10px",float:"left","margin-left":"340px"}},[e("Button",{staticStyle:{width:"100px","margin-right":"40px"},attrs:{type:"primary"},on:{click:t.gotoLast}},[t._v("上一步")]),t._v(" "),e("Button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")])],1)])],1)],1)],1)},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticStyle:{"margin-left":"40px"}},[i("img",{staticStyle:{width:"30px",height:"30px"},attrs:{src:"/static/img/one.png"}}),this._v(" "),i("img",{staticStyle:{width:"400px",height:"30px",overflow:"hidden"},attrs:{src:"/static/img/line.png"}}),this._v(" "),i("img",{staticStyle:{width:"30px",height:"30px"},attrs:{src:"/static/img/2.png"}})])},function(){var t=this.$createElement,i=this._self._c||t;return i("div",[i("span",{staticStyle:{color:"black","margin-right":"320px"}},[this._v("填写问卷基本信息")]),this._v(" "),i("span",{staticStyle:{color:"#ccc"}},[this._v("设置问卷题目与解释")])])}]};var s=e("C7Lr")(n,o,!1,function(t){e("edtq")},"data-v-230c2980",null);i.default=s.exports},edtq:function(t,i){}});
//# sourceMappingURL=10.42f93f3bc935b83aacdd.js.map