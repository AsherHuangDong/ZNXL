webpackJsonp([12],{"4cRY":function(t,e){},"7l17":function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=o("3cXf"),i=o.n(s),a={components:{VueEditor:o("WHp7").a},data:function(){return{showDel:!1,isShowTask:!1,nodeId:"",upId:"",isShowTaskEdit:!1,modelEdit:!0,editNode1:{},editNode:{nodeId:"",term:"0",termValue:"",nodeTextList:[],taskResourceMap:{isComment:2,taskResourceList:[{contentId:"",type:"",status:1}]}},taskResourceList:{type:"",status:2,contentId:[]},resourceType:[{type:1,value:"音频"},{type:2,value:"视频"},{type:3,value:"电子书"},{type:4,value:"问卷"},{type:5,value:"表单"},{type:6,value:"小游戏"}],contentList:[]}},methods:{addOption:function(t){this.editNode.nodeTextList[t].textOptionList.push({option:"",optionContent:""})},deleteOption:function(t,e){console.log(e),this.editNode.nodeTextList[t].textOptionList.splice(e,1)},getDetail:function(){var t=this;this.$axios.post("api/verbalTrickNode/selectVerbalTrickNode",{nodeId:this.nodeId}).then(function(e){t.editNode1=e.data.data,t.editNode.nodeId=t.nodeId,t.editNode.upId=t.editNode1.upId,t.editNode1.term&&(t.editNode.term=t.editNode1.term),t.editNode.termValue=t.editNode1.termValue,t.editNode1.nodeTextList1&&t.editNode1.nodeTextList1.forEach(function(e){t.editNode.nodeTextList.push(e)}),"{}"==i()(t.editNode1.taskResourceMap)?(t.isShowTask=!0,t.editNode.taskResourceMap={}):(t.isShowTaskEdit=!0,1==t.editNode1.taskResourceMap.isComment&&(t.editNode.taskResourceMap.isComment=!0),2==t.editNode1.taskResourceMap.isComment&&(t.editNode.taskResourceMap.isComment=!1),t.editNode1.taskResourceMap.list.forEach(function(e){1==e.status?t.editNode.taskResourceMap.taskResourceList[0]=e:(t.taskResourceList.type=e.type,t.taskResourceList.contentId.push(e.contentId))}),t.select2(t.editNode.taskResourceMap.taskResourceList[0].type)),console.log("eidtNode",t.editNode)})},addText:function(){this.editNode.nodeTextList.push({content:"",textOptionList:[]})},addTask:function(){var t=this;this.isShowTask=!1,this.editNode.taskResourceMap={isComment:2,taskResourceList:[{type:1,status:1,contentId:""}]},this.taskResourceList.type=1,this.$axios.post("api/taskResource/getTaskResourceList",{type:this.editNode.taskResourceMap.taskResourceList[0].type}).then(function(e){t.contentList=e.data.data,t.editNode.taskResourceMap.taskResourceList[0].contentId=t.contentList[0].contentId,t.taskResourceList.contentId=[]}),this.isShowTaskEdit=!0,this.isShowTask2=!1},deleteTask1:function(){this.editNode.taskResourceMap={},this.isShowTaskEdit=!1,this.isShowTask=!0},select2:function(t){var e=this;console.log("e",t);var o=this.editNode.taskResourceMap.taskResourceList[0].type;this.editNode.taskResourceMap.taskResourceList[0].type=t,this.taskResourceList.type=t,this.$axios.post("api/taskResource/getTaskResourceList",{type:t}).then(function(s){console.log(s),e.contentList=s.data.data,o!=t&&(e.editNode.taskResourceMap.taskResourceList[0].contentId="",e.taskResourceList.contentId=[])})},deleteText1:function(t){this.editNode.nodeTextList.splice(t,1)},save:function(){var t=this,e={taskResourceMap:{}};if(e.nodeId=this.editNode.nodeId,this.editNode.term&&this.editNode.termValue&&3!=this.editNode.term&&(e.term=this.editNode.term,e.termValue=this.editNode.termValue),3==this.editNode.term&&(e.term=this.editNode.term),e.nodeTextList=this.editNode.nodeTextList,"{}"!=i()(this.editNode.taskResourceMap)?(e.taskResourceMap=JSON.parse(i()(this.editNode.taskResourceMap)),1==e.taskResourceMap.isComment&&(e.taskResourceMap.isComment=1),0==e.taskResourceMap.isComment&&(e.taskResourceMap.isComment=2),0!=this.taskResourceList.contentId.length&&this.taskResourceList.contentId.forEach(function(o){e.taskResourceMap.taskResourceList.push({type:t.taskResourceList.type,status:2,contentId:o})}),delete e.taskResourceMap.taskResourceList[0].resourceName):delete e.taskResourceMap,0!=e.nodeTextList.length){var o=1,s=1,a=1;if(e.nodeTextList.forEach(function(t){t.content||(o=2),0!=t.textOptionList.length&&t.textOptionList.forEach(function(t){t.option||(s=2),t.optionContent||(a=2)})}),2==o)return this.$Message.info("请输入文本内容"),!1;if(2==s)return this.$Message.info("请输入选项"),!1;if(2==a)return this.$Message.info("请输入选项对应内容"),!1}if(3!=e.term&&(console.log("ffff"),!e.termValue))return this.$Message.info("请输入触发条件内容"),!1;console.log("editNewNode",e),this.$axios.post("api/verbalTrickNode/editVerbalTrickNode",e).then(function(e){0==e.data.code?(console.log(e),t.$Message.success("修改成功！"),t.$router.go(-1)):t.$Message.error(e.data.msg)})},toDel:function(){this.showDel=!0},del:function(){var t=this;this.$axios.post("api/verbalTrickNode/deleteVerbalTrickNode",{nodeId:this.nodeId}).then(function(e){0==e.data.code?(t.$router.go(-1),t.$Message.success("删除成功！")):t.$Message.error(e.data.msg)})},cancel:function(){this.$router.go(-1)},cancelDel:function(){this.showDel=!1},removeHTMLTag:function(t){return t=(t=(t=t.replace(/<\/?[^>]*>/g,"")).replace(/[ | ]*\n/g,"\n")).replace(/ /gi,"")},handleImageAdded:function(t,e,o,s){var i=new FormData;i.append("img",t),this.$axios.post("api/file/upload",i).then(function(t){var i=t.data.data.path;e.insertEmbed(o,"image",i),s()}).catch(function(t){console.log(t)})}},mounted:function(){this.nodeId=this.$route.query.id,this.upId=this.$route.query.upId,console.log(this.nodeId),console.log(this.upId),this.getDetail()}},n={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"editNodeText"}},[o("Modal",{staticStyle:{padding:"16px"},attrs:{width:"360","mask-closable":!1,closable:!1},model:{value:t.showDel,callback:function(e){t.showDel=e},expression:"showDel"}},[o("p",{staticStyle:{color:"#f60","text-align":"center"},attrs:{slot:"header"},slot:"header"},[o("Icon",{attrs:{type:"ios-information-circle"}}),t._v(" "),o("span",[t._v("是否删除该条数据？")])],1),t._v(" "),o("div",{staticStyle:{"text-align":"center"}},[o("p",[t._v("删除数据后将无法恢复")])]),t._v(" "),o("div",{staticStyle:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"error"},on:{click:t.del}},[t._v("删除")]),t._v(" "),o("Button",{staticStyle:{"margin-left":"40px"},on:{click:t.cancelDel}},[t._v("取消")])],1)]),t._v(" "),o("div",[o("Modal",{attrs:{width:"700","mask-closable":!1,closable:!1,transfer:!1},model:{value:t.modelEdit,callback:function(e){t.modelEdit=e},expression:"modelEdit"}},[o("p",{attrs:{slot:"header"},slot:"header"},[o("span",{staticStyle:{"font-size":"20px"}},[t._v("话术详情")])]),t._v(" "),o("div",{staticClass:"editText"},[o("Button",{staticStyle:{displa:"inline-block"},attrs:{type:"primary"},on:{click:t.addText}},[t._v("新增文本")]),t._v(" "),t.isShowTask?o("Button",{staticStyle:{displa:"inline-block"},attrs:{type:"primary"},on:{click:t.addTask}},[t._v("新增任务")]):t._e(),t._v(" "),t.isShowTask?t._e():o("Button",{staticStyle:{displa:"inline-block"},attrs:{disabled:"",type:"primary"}},[t._v("新增任务")])],1),t._v(" "),o("div",{staticStyle:{"margin-top":"56px"}},t._l(t.editNode.nodeTextList,function(e,s){return o("div",{key:s,staticStyle:{"background-color":"rgba(235, 240, 251, 1)","padding-bottom":"10px",width:"638px","margin-bottom":"10px"}},[o("span",{staticStyle:{color:"#07175D",display:"inline-block","text-align":"left","margin-left":"10px","margin-top":"10px"}},[t._v("话术文本")]),t._v(" "),o("a",{staticStyle:{color:"red",display:"inline-block",float:"right","margin-right":"10px","margin-top":"10px"},on:{click:function(e){return t.deleteText1(s)}}},[t._v("删除")]),t._v(" "),o("VueEditor",{staticStyle:{width:"620px","margin-left":"10px","margin-top":"5px",background:"#fff"},attrs:{useCustomImageHandler:""},on:{"image-added":t.handleImageAdded},model:{value:e.content,callback:function(o){t.$set(e,"content",o)},expression:"item.content"}}),t._v(" "),o("a",{staticStyle:{"font-size":"10px",color:"blue","margin-left":"10px","margin-top":"10px"},on:{click:function(e){return t.addOption(s)}}},[t._v("+新增选项")]),t._v(" "),t._l(e.textOptionList,function(e,i){return o("div",{key:i,staticStyle:{width:"620px",display:"flex","justify-content":"space-between","align-items":"center","padding-left":"10px","margin-top":"10px"}},[o("Input",{staticStyle:{width:"50px","margin-right":"10px","text-align":"center"},model:{value:e.option,callback:function(o){t.$set(e,"option",o)},expression:"item1.option"}}),t._v(" "),o("Input",{staticStyle:{width:"550px","margin-right":"10px"},attrs:{placeholder:"请输入选项内容"},model:{value:e.optionContent,callback:function(o){t.$set(e,"optionContent",o)},expression:"item1.optionContent"}}),t._v(" "),o("img",{staticStyle:{width:"20px",height:"20px",margin:"0",cursor:"pointer"},attrs:{src:"static/img/remove.png"},on:{click:function(e){return t.deleteOption(s,i)}}})],1)})],2)}),0),t._v(" "),o("br"),t._v(" "),t.isShowTaskEdit?o("div",[o("div",{staticStyle:{"background-color":"rgba(235, 240, 251, 1)",width:"638px",height:"168px","margin-bottom":"10px"}},[o("span",{staticStyle:{color:"#07175D",display:"inline-block","text-align":"left","margin-left":"10px","margin-top":"10px"}},[t._v("任务资源")]),t._v(" "),o("a",{staticStyle:{color:"red",display:"inline-block",float:"right","margin-right":"10px","margin-top":"10px"},on:{click:t.deleteTask1}},[t._v("删除")]),t._v(" "),o("div",{staticStyle:{"margin-top":"10px"}},[o("span",{staticStyle:{color:"#07175D",display:"inline-block","text-align":"left","margin-left":"10px","margin-top":"10px"}},[t._v("推荐资源")]),t._v(" "),o("Select",{staticStyle:{width:"70px"},on:{"on-change":t.select2},model:{value:t.editNode.taskResourceMap.taskResourceList[0].type,callback:function(e){t.$set(t.editNode.taskResourceMap.taskResourceList[0],"type",e)},expression:"editNode.taskResourceMap.taskResourceList[0].type"}},t._l(t.resourceType,function(e,s){return o("Option",{key:s,attrs:{value:e.type}},[t._v(t._s(e.value))])}),1),t._v(" "),o("Select",{staticStyle:{width:"490px"},model:{value:t.editNode.taskResourceMap.taskResourceList[0].contentId,callback:function(e){t.$set(t.editNode.taskResourceMap.taskResourceList[0],"contentId",e)},expression:"editNode.taskResourceMap.taskResourceList[0].contentId"}},t._l(t.contentList,function(e,s){return o("Option",{key:s,attrs:{value:e.contentId}},[t._v(t._s(e.title))])}),1)],1),t._v(" "),o("div",{staticStyle:{"margin-top":"10px"}},[o("span",{staticStyle:{color:"#07175D",display:"inline-block","text-align":"left","margin-left":"10px","margin-top":"10px"}},[t._v("备选资源")]),t._v(" "),o("Select",{staticStyle:{width:"70px"},on:{"on-change":t.select2},model:{value:t.taskResourceList.type,callback:function(e){t.$set(t.taskResourceList,"type",e)},expression:"taskResourceList.type"}},t._l(t.resourceType,function(e,s){return o("Option",{key:s,attrs:{value:e.type}},[t._v(t._s(e.value))])}),1),t._v(" "),o("Select",{staticStyle:{width:"490px"},attrs:{multiple:""},model:{value:t.taskResourceList.contentId,callback:function(e){t.$set(t.taskResourceList,"contentId",e)},expression:"taskResourceList.contentId"}},t._l(t.contentList,function(e,s){return o("Option",{key:s,attrs:{value:e.contentId}},[t._v(t._s(e.title))])}),1)],1),t._v(" "),o("Checkbox",{staticStyle:{"margin-left":"10px","margin-top":"10px"},model:{value:t.editNode.taskResourceMap.isComment,callback:function(e){t.$set(t.editNode.taskResourceMap,"isComment",e)},expression:"editNode.taskResourceMap.isComment"}},[t._v("接受用户评价")])],1)]):t._e(),t._v(" "),o("br"),t._v(" "),o("div",[o("div",{staticStyle:{width:"57px",height:"20px"}},[o("p",[o("span",{staticStyle:{color:"#07175D","font-size":"14px"}},[t._v("触发条件")])])]),t._v(" "),o("br"),t._v(" "),o("div",[o("Select",{staticStyle:{width:"100px",display:"inline-block"},attrs:{transfer:""},model:{value:t.editNode.term,callback:function(e){t.$set(t.editNode,"term",e)},expression:"editNode.term"}},[o("Option",{attrs:{value:3}},[t._v("无")]),t._v(" "),o("Option",{attrs:{value:1}},[t._v("用户选择")]),t._v(" "),o("Option",{attrs:{value:2}},[t._v("用户输入")])],1),t._v(" "),t.editNode.term&&3!=t.editNode.term?o("Input",{staticStyle:{width:"56px",display:"inline-block","text-align":"center"},attrs:{type:"text",placeholder:"请输入内容"},model:{value:t.editNode.termValue,callback:function(e){t.$set(t.editNode,"termValue",e)},expression:"editNode.termValue"}}):t._e()],1)]),t._v(" "),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{staticStyle:{float:"left"},attrs:{type:"error"},on:{click:t.toDel}},[t._v("删除")]),t._v(" "),o("Button",{on:{click:t.cancel}},[t._v("取消")]),t._v(" "),o("Button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("确定")])],1)])],1)],1)},staticRenderFns:[]};var d=o("C7Lr")(a,n,!1,function(t){o("4cRY")},"data-v-022e4bf0",null);e.default=d.exports}});
//# sourceMappingURL=12.2d3e921958a0519e910e.js.map